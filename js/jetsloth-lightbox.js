!function(t,e,n,i){"use strict";t.fn.jetslothLightbox=function(i){var o,i=t.extend({sourceAttr:"href",overlay:!0,spinner:!0,nav:!0,navText:["&lsaquo;","&rsaquo;"],captions:!0,captionDelay:0,captionSelector:"self",captionType:"attr",captionsData:"title",captionPosition:"bottom",captionClass:"",close:!0,closeText:"Ã—",swipeClose:!0,showCounter:!0,fileExt:"png|jpg|jpeg|gif",animationSlide:!0,animationSpeed:250,preloading:!0,enableKeyboard:!0,loop:!0,rel:!1,docClose:!0,swipeTolerance:50,className:"jetsloth-lightbox",widthRatio:.8,heightRatio:.9,scaleImageToRatio:!1,disableRightClick:!1,disableScroll:!0,alertError:!0,alertErrorMessage:"Image not found, next image will be loaded",additionalHtml:!1,history:!0,throttleInterval:0},i),a=(e.navigator.pointerEnabled||e.navigator.msPointerEnabled,0),r=0,l=t(),s=function(){var t=n.body||n.documentElement;return t=t.style,""===t.WebkitTransition?"-webkit-":""===t.MozTransition?"-moz-":""===t.OTransition?"-o-":""===t.transition&&""},c=!1,d=[],h=function(e,n){var i=n.filter(function(){return t(this).attr("rel")===e});return i},p=i.rel&&i.rel!==!1?h(i.rel,t(this)):this,s=s(),u=0,g=s!==!1,f="pushState"in history,v=!1,m=e.location,j=function(){return m.hash.substring(1)},x=j(),b=function(){var t=(j(),"pid="+(M+1)),e=m.href.split("#")[0]+"#"+t;f?history[v?"replaceState":"pushState"]("",n.title,e):v?m.replace(e):m.hash=t,v=!0},y=function(){f?history.pushState("",n.title,m.pathname+m.search):m.hash="",clearTimeout(o)},w=function(){v?o=setTimeout(b,800):b()},T=function(t,e){var n;return function(){var i=arguments,o=this;n||(t.apply(o,i),n=!0,setTimeout(function(){return n=!1},e))}},E="jetslothlb",C=t("<div>").addClass("jl-overlay"),S=t("<button>").addClass("jl-close").html(i.closeText),I=t("<div>").addClass("jl-spinner").html("<div></div>"),k=t("<div>").addClass("jl-navigation").html('<button class="jl-prev">'+i.navText[0]+'</button><button class="jl-next">'+i.navText[1]+"</button>"),q=t("<div>").addClass("jl-counter").html('<span class="jl-current"></span>/<span class="jl-total"></span>'),D=!1,M=0,R=0,A=t("<div>").addClass("jl-caption "+i.captionClass+" pos-"+i.captionPosition),O=t("<div>").addClass("jl-image"),W=t("<div>").addClass("jl-wrapper").addClass(i.className),P=function(e){if(!i.fileExt)return!0;var n=/\.([0-9a-z]+)(?=[?#])|(\.)(?:[\w]+)$/gim,o=t(e).attr(i.sourceAttr).match(n);return o&&"a"==t(e).prop("tagName").toLowerCase()&&new RegExp(".("+i.fileExt+")$","i").test(o)},z=function(){i.close&&S.appendTo(W),i.showCounter&&p.length>1&&(q.appendTo(W),q.find(".jl-total").text(p.length)),i.nav&&k.appendTo(W),i.spinner&&I.appendTo(W)},H=function(e){e.trigger(t.Event("show.jetslothlightbox")),i.disableScroll&&(u=U("hide")),W.appendTo("body"),O.appendTo(W),i.overlay&&C.appendTo(t("body")),D=!0,M=p.index(e),l=t("<img/>").hide().attr("src",e.attr(i.sourceAttr)),d.indexOf(e.attr(i.sourceAttr))==-1&&d.push(e.attr(i.sourceAttr)),O.html("").attr("style",""),l.appendTo(O),Y(),C.fadeIn("fast"),t(".jl-close").fadeIn("fast"),I.show(),k.fadeIn("fast"),t(".jl-wrapper .jl-counter .jl-current").text(M+1),q.fadeIn("fast"),L(),i.preloading&&$(),setTimeout(function(){e.trigger(t.Event("shown.jetslothlightbox"))},i.animationSpeed)},L=function(n){if(l.length){var o=new Image,a=e.innerWidth*i.widthRatio,r=e.innerHeight*i.heightRatio;o.src=l.attr("src"),t(o).on("error",function(e){p.eq(M).trigger(t.Event("error.jetslothlightbox")),D=!1,c=!0,I.hide();var o=1==n||n==-1;return R===M&&o?void Q():(i.alertError&&alert(i.alertErrorMessage),void B(o?n:1))}),o.onload=function(){"undefined"!=typeof n&&p.eq(M).trigger(t.Event("changed.jetslothlightbox")).trigger(t.Event((1===n?"nextDone":"prevDone")+".jetslothlightbox")),i.history&&w(),d.indexOf(l.attr("src"))==-1&&d.push(l.attr("src"));var s=o.width,h=o.height;if(i.scaleImageToRatio||s>a||h>r){var f=s/h>a/r?s/a:h/r;s/=f,h/=f}t(".jl-image").css({top:(e.innerHeight-h)/2+"px",left:(e.innerWidth-s-u)/2+"px"}),I.hide(),l.css({width:s+"px",height:h+"px"}).fadeIn("fast"),c=!0;var v,m="self"==i.captionSelector?p.eq(M):p.eq(M).find(i.captionSelector);if(v="data"==i.captionType?m.data(i.captionsData):"text"==i.captionType?m.html():m.prop(i.captionsData),i.loop||(0===M&&t(".jl-prev").hide(),M>=p.length-1&&t(".jl-next").hide(),M>0&&t(".jl-prev").show(),M<p.length-1&&t(".jl-next").show()),1==p.length&&t(".jl-prev, .jl-next").hide(),1==n||n==-1){var j={opacity:1};i.animationSlide&&(g?(N(0,100*n+"px"),setTimeout(function(){N(i.animationSpeed/1e3,"0px")},50)):j.left=parseInt(t(".jl-image").css("left"))+100*n+"px"),t(".jl-image").animate(j,i.animationSpeed,function(){D=!1,X(v,s)})}else D=!1,X(v,s);i.additionalHtml&&0===t(".jl-additional-html").length&&t("<div>").html(i.additionalHtml).addClass("jl-additional-html").appendTo(t(".jl-image"))}}},X=function(e,n){""!==e&&"undefined"!=typeof e&&i.captions&&A.html(e).css({width:n+"px"}).hide().appendTo(t(".jl-image")).delay(i.captionDelay).fadeIn("fast")},N=function(e,n){var i={};i[s+"transform"]="translateX("+n+")",i[s+"transition"]=s+"transform "+e+"s linear",t(".jl-image").css(i)},Y=function(){t(e).on("resize."+E,L),t(n).on("click."+E+" touchstart."+E,".jl-close",function(t){t.preventDefault(),c&&Q()}),i.history&&setTimeout(function(){t(e).on("hashchange."+E,function(){if(c&&j()===x)return void Q()})},40),k.on("click."+E,"button",T(function(e){e.preventDefault(),a=0,B(t(this).hasClass("jl-next")?1:-1)},i.throttleInterval));var o=0,l=0,s=0,d=0,h=!1,u=0;O.on("touchstart."+E+" mousedown."+E,function(t){return!!h||(g&&(u=parseInt(O.css("left"))),h=!0,a=0,r=0,o=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,s=t.originalEvent.pageY||t.originalEvent.touches[0].pageY,!1)}).on("touchmove."+E+" mousemove."+E+" pointermove MSPointerMove",function(t){return!h||(t.preventDefault(),l=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,d=t.originalEvent.pageY||t.originalEvent.touches[0].pageY,a=o-l,r=s-d,void(i.animationSlide&&(g?N(0,-a+"px"):O.css("left",u-a+"px"))))}).on("touchend."+E+" mouseup."+E+" touchcancel."+E+" mouseleave."+E+" pointerup pointercancel MSPointerUp MSPointerCancel",function(t){if(h){h=!1;var e=!0;i.loop||(0===M&&a<0&&(e=!1),M>=p.length-1&&a>0&&(e=!1)),Math.abs(a)>i.swipeTolerance&&e?B(a>0?1:-1):i.animationSlide&&(g?N(i.animationSpeed/1e3,"0px"):O.animate({left:u+"px"},i.animationSpeed/2)),i.swipeClose&&Math.abs(r)>50&&Math.abs(a)<i.swipeTolerance&&Q()}})},K=function(){k.off("click","button"),t(n).off("click."+E,".jl-close"),t(e).off("resize."+E),t(e).off("hashchange."+E)},$=function(){var e=M+1<0?p.length-1:M+1>=p.length-1?0:M+1,n=M-1<0?p.length-1:M-1>=p.length-1?0:M-1;t("<img />").attr("src",p.eq(e).attr(i.sourceAttr)).on("load",function(){d.indexOf(t(this).attr("src"))==-1&&d.push(t(this).attr("src")),p.eq(M).trigger(t.Event("nextImageLoaded.jetslothlightbox"))}),t("<img />").attr("src",p.eq(n).attr(i.sourceAttr)).on("load",function(){d.indexOf(t(this).attr("src"))==-1&&d.push(t(this).attr("src")),p.eq(M).trigger(t.Event("prevImageLoaded.jetslothlightbox"))})},B=function(e){p.eq(M).trigger(t.Event("change.jetslothlightbox")).trigger(t.Event((1===e?"next":"prev")+".jetslothlightbox"));var n=M+e;if(!(D||(n<0||n>=p.length)&&i.loop===!1)){M=n<0?p.length-1:n>p.length-1?0:n,t(".jl-wrapper .jl-counter .jl-current").text(M+1);var o={opacity:0};i.animationSlide&&(g?N(i.animationSpeed/1e3,-100*e-a+"px"):o.left=parseInt(t(".jl-image").css("left"))+-100*e+"px"),t(".jl-image").animate(o,i.animationSpeed,function(){setTimeout(function(){var n=p.eq(M);l.attr("src",n.attr(i.sourceAttr)),d.indexOf(n.attr(i.sourceAttr))==-1&&I.show(),t(".jl-caption").remove(),L(e),i.preloading&&$()},100)})}},Q=function(){if(!D){var e=p.eq(M),n=!1;e.trigger(t.Event("close.jetslothlightbox")),i.history&&y(),t(".jl-image img, .jl-overlay, .jl-close, .jl-navigation, .jl-image .jl-caption, .jl-counter").fadeOut("fast",function(){i.disableScroll&&U("show"),t(".jl-wrapper, .jl-overlay").remove(),K(),n||e.trigger(t.Event("closed.jetslothlightbox")),n=!0}),l=t(),c=!1,D=!1}},U=function(i){var o=0;if("hide"==i){var a=e.innerWidth;if(!a){var r=n.documentElement.getBoundingClientRect();a=r.right-Math.abs(r.left)}if(n.body.clientWidth<a){var l=n.createElement("div"),s=parseInt(t("body").css("padding-right"),10);l.className="jl-scrollbar-measure",t("body").append(l),o=l.offsetWidth-l.clientWidth,t(n.body)[0].removeChild(l),t("body").data("padding",s),o>0&&t("body").addClass("hidden-scroll").css({"padding-right":s+o})}}else t("body").removeClass("hidden-scroll").css({"padding-right":t("body").data("padding")});return o};return z(),p.on("click."+E,function(e){if(P(this)){if(e.preventDefault(),D)return!1;var n=t(this);R=p.index(n),H(n)}}),t(n).on("click."+E+" touchstart."+E,function(e){c&&i.docClose&&0===t(e.target).closest(".jl-image").length&&0===t(e.target).closest(".jl-navigation").length&&Q()}),i.disableRightClick&&t(n).on("contextmenu",".jl-image img",function(t){return!1}),i.enableKeyboard&&t(n).on("keyup."+E,T(function(t){a=0;var e=t.keyCode;D&&27==e&&(l.attr("src",""),D=!1,Q()),c&&(t.preventDefault(),27==e&&Q(),37!=e&&39!=t.keyCode||B(39==t.keyCode?1:-1))},i.throttleInterval)),this.open=function(e){e=e||t(this[0]),R=p.index(e),H(e)},this.next=function(){B(1)},this.prev=function(){B(-1)},this.close=function(){Q()},this.destroy=function(){t(n).off("click."+E).off("keyup."+E),Q(),t(".jl-overlay, .jl-wrapper").remove(),this.off("click")},this.refresh=function(){this.destroy(),t(this).jetslothLightbox(i)},this}}(jQuery,window,document);